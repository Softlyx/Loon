# Loonå…¨å±€é…ç½® by Tartarus
# ä½œè€…GitHubï¼š https://github.com/Tartarus2014
# è„šæœ¬åº“GitHubï¼š https://github.com/Tartarus2014/Loon-Script
# Loonæ•™ç¨‹é“¾æ¥ï¼šhttps://github.com/TiyNa/LoonManual
# Loonè§„åˆ™GitHubï¼šhttps://github.com/blackmatrix7/ios_rule_script/tree/master/rule/Loon

# å¯¼å…¥é…ç½®å,æ·»åŠ æœºåœºè®¢é˜…é“¾æ¥,ä¹‹åæ›´æ–°è®¢é˜…è§„åˆ™ã€‚
# ç‚¹å‡»é…ç½®-è¯ä¹¦ç®¡ç†-ç”Ÿæˆæ–°çš„CAè¯ä¹¦ï¼Œä¹‹åè¿›å…¥ã€Œè®¾ç½®ã€>ã€Œé€šç”¨ã€>ã€Œæè¿°æ–‡ä»¶ã€, å®‰è£…Loonçš„è¯ä¹¦, å¹¶åœ¨ã€Œè®¾ç½®ã€>ã€Œé€šç”¨ã€>ã€Œå…³äºæœ¬æœºã€>ã€Œè¯ä¹¦ä¿¡ä»»è®¾ç½®ã€å¼€å¯å¯¹Loonè¯ä¹¦çš„ä¿¡ä»»ã€‚
# å¼€å¯å¹¶æ›´æ–°è„šæœ¬å’Œæ’ä»¶ã€‚

# å…¨åˆ†ç»„
# å»å¹¿å‘Šæ’ä»¶, VIPè„šæœ¬, ç­¾åˆ°, cookie,
# äº‘éŸ³ä¹è§£é”è§„åˆ™, èŠ‚ç‚¹è¿œç¨‹è®¢é˜…, é»˜è®¤ç›´è¿, å¯åœ¨ç­–ç•¥ç»„æ‰‹åŠ¨å¼€å¯ã€‚
# è¯·ä½¿ç”¨ Safari æµè§ˆå™¨è®¿é—® https://cdn.jsdelivr.net/gh/nondanee/UnblockNeteaseMusic@master/ca.crt ã€‚é¦–å…ˆä¸‹è½½è¯ä¹¦, è¿›å…¥ã€Œè®¾ç½®ã€>ã€Œé€šç”¨ã€>ã€Œæè¿°æ–‡ä»¶ã€, å®‰è£…ã€ŒUnblockNeteaseMusic Root CAã€, å¹¶åœ¨ã€Œè®¾ç½®ã€>ã€Œé€šç”¨ã€>ã€Œå…³äºæœ¬æœºã€>ã€Œè¯ä¹¦ä¿¡ä»»è®¾ç½®ã€å¼€å¯å¯¹ã€ŒUnblockNeteaseMusic Root CAã€çš„ä¿¡ä»»ã€‚

[General]
doh-server = https://doh.pub/dns-query,https://dns.alidns.com/dns-query,https://1.12.12.12/dns-query,https://120.53.53.53/dns-query,https://223.5.5.5/dns-query,https://223.6.6.6/dns-query
# IPv6 æ”¯æŒ
ipv6 = true
# > è·³è¿‡æŸä¸ªåŸŸåæˆ–è€…IPæ®µ
skip-proxy = 127.0.0.1,192.168.0.0/16,10.0.0.0/8,172.16.0.0/12,100.64.0.0/10,localhost,*.local,passenger.t3go.cn,passenger.t3go.cn
bypass-tun = 10.0.0.0/8,100.64.0.0/10,127.0.0.0/8,169.254.0.0/16,172.16.0.0/12,192.0.0.0/24,192.0.2.0/24,192.88.99.0/24,192.168.0.0/16,198.18.0.0/15,198.51.100.0/24,203.0.113.0/24,224.0.0.0/4,255.255.255.255/32
# DNS æœåŠ¡å™¨
dns-server = system,119.29.29.29,223.5.5.5,223.6.6.6,8.8.8.8,8.8.4.4,1.1.1.1,1.0.0.1
# Wi-Fi è®¿é—®
# > å…è®¸ Wi-Fi ç½‘ç»œä¸‹å…¶å®ƒè®¾å¤‡è®¿é—®
allow-udp-proxy = true
allow-wifi-access = false
wifi-access-http-port = 7222
wifi-access-socks5-port = 7221
# > ä»£ç†æµ‹é€Ÿ URL
proxy-test-url = http://www.gstatic.com/generate_204
# > æµ‹é€Ÿè¶…æ—¶ (s)
test-timeout = 5
interface-mode = auto
# > è§£å†³ä¸€äº›ipè¯·æ±‚æ— æ³•åŒ¹é…åŸŸåç±»è§„åˆ™çš„é—®é¢˜ã€‚real-ipæŒ‡å®šçš„åŸŸåå°†ä¸è¿”å›fake ipå“åº”ï¼Œç›´æ¥å°†dnsè¯·æ±‚å‘å¾€ç›®æ ‡dnsæœåŠ¡å™¨
real-ip = msftconnecttest.com, msftncsi.com, *.msftconnecttest.com, *.msftncsi.com, *.srv.nintendo.net, *.stun.playstation.net, xbox.*.microsoft.com, *.xboxlive.com, *.battlenet.com.cn, *.battlenet.com, *.blzstatic.cn, *.battle.net
# è§£æå™¨
resource-parser = https://raw.githubusercontent.com/Peng-YM/Sub-Store/master/backend/dist/sub-store-parser.loon.min.js
# ssid-triggerå‚æ•°ï¼Œç”¨äºæŒ‡å®šSSIDä¸‹æµé‡æ¨¡å¼åˆ‡æ¢ï¼Œï¼ˆdefaultè¡¨ç¤ºé»˜è®¤ï¼Œcellularè¡¨ç¤ºèœ‚çªï¼Œç›®å‰æ”¯æŒä¸‰ç§å€¼ï¼šruleï¼Œdirectï¼Œproxyï¼‰ 
# ssid-trigger="default":rule,"cellular":rule,"ASUS":direct,"TPLINK":proxy 

[Host]
*.taobao.com = server:223.5.5.5
*.tmall.com = server:223.5.5.5
*.jd.com = server:119.28.28.28
*.qq.com = server:119.28.28.28
*.tencent.com = server:119.28.28.28
*.alicdn.com = server:223.5.5.5
*.aliyun.com = server:223.5.5.5
*.weixin.com = server:119.28.28.28
*.163.com = server:119.29.29.29
*.126.com = server:119.29.29.29
*.126.net = server:119.29.29.29
*.127.net = server:119.29.29.29
*.netease.com = server:119.29.29.29
*.mi.com = server:119.29.29.29
*.xiaomi.com = server:119.29.29.29
*.bilibili.com = server:119.29.29.29
*testflight.apple.com = server:8.8.4.4
mtalk.google.com = 108.177.125.188
dl.google.com = server:119.29.29.29
dl.l.google.com = server:119.29.29.29

[Proxy]

[Remote Proxy]


[Proxy Group]
# èŠ‚ç‚¹ç­–ç•¥
èŠ‚ç‚¹ç­–ç•¥ = select,é¦™æ¸¯èŠ‚ç‚¹,ç¾å›½èŠ‚ç‚¹,img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Rocket.png
æ‰‹åŠ¨é€‰æ‹© = select,ALL,img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Available_1.png

# è‡ªåŠ¨ç­–ç•¥ç»„
å»¶è¿Ÿä¼˜é€‰ = url-test,é¦™æ¸¯èŠ‚ç‚¹,å°æ¹¾èŠ‚ç‚¹,æ—¥æœ¬èŠ‚ç‚¹,ç¾å›½èŠ‚ç‚¹,url = http://www.gstatic.com/generate_204,interval = 60,img-url = goforward
æ•…éšœè½¬ç§» = fallback,é¦™æ¸¯èŠ‚ç‚¹,å°æ¹¾èŠ‚ç‚¹,æ—¥æœ¬èŠ‚ç‚¹,ç¾å›½èŠ‚ç‚¹,url = http://www.gstatic.com/generate_204,interval = 60,max-timeout = 3000,img-url = gobackward
è´Ÿè½½å‡è¡¡ = load-balance,é¦™æ¸¯èŠ‚ç‚¹,å°æ¹¾èŠ‚ç‚¹,æ—¥æœ¬èŠ‚ç‚¹,ç¾å›½èŠ‚ç‚¹,url = http://www.gstatic.com/generate_204,interval = 60,max-timeout = 3000,algorithm = pcc,img-url = repeat

SpeedTest = select,æ‰‹åŠ¨é€‰æ‹©,img-url = https://raw.githubusercontent.com/Softlyx/QuantumultX/main/icon/Policy/Speedtest.png
å¹¿å‘Šæ‹¦æˆª = select,REJECT,DIRECT,img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Advertising.png
Emby = select,DIRECT,æ‰‹åŠ¨é€‰æ‹©,é¦™æ¸¯èŠ‚ç‚¹,æ—¥æœ¬èŠ‚ç‚¹,ç¾å›½èŠ‚ç‚¹,img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Emby.png
TikTokæ¢åŒº = select,é¦™æ¸¯èŠ‚ç‚¹,æ—¥æœ¬èŠ‚ç‚¹,ç¾å›½èŠ‚ç‚¹,img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/TikTok.png
Google Voice = select,ALL,img-url = https://raw.githubusercontent.com/Softlyx/QuantumultX/main/icon/GV.png
å›½é™…ç¤¾äº¤ = select,èŠ‚ç‚¹ç­–ç•¥,é¦™æ¸¯èŠ‚ç‚¹,æ—¥æœ¬èŠ‚ç‚¹,ç¾å›½èŠ‚ç‚¹,img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Google_Search.png
å›½å¤–åª’ä½“ = select,èŠ‚ç‚¹ç­–ç•¥,é¦™æ¸¯èŠ‚ç‚¹,æ—¥æœ¬èŠ‚ç‚¹,ç¾å›½èŠ‚ç‚¹,img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/YouTube.png
å…¨çƒåŠ é€Ÿ = select,èŠ‚ç‚¹ç­–ç•¥,é¦™æ¸¯èŠ‚ç‚¹,æ—¥æœ¬èŠ‚ç‚¹,ç¾å›½èŠ‚ç‚¹,img-url = https://raw.githubusercontent.com/Softlyx/QuantumultX/main/icon/wukong.png
è‹¹æœæœåŠ¡ = select,DIRECT,REJECT,èŠ‚ç‚¹ç­–ç•¥,img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Apple.png
å›½å†…æœåŠ¡ = select,DIRECT,REJECT,èŠ‚ç‚¹ç­–ç•¥,img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/China.png

# é¦™æ¸¯èŠ‚ç‚¹
é¦™æ¸¯èŠ‚ç‚¹ = url-test,é¦™æ¸¯,url = http://www.gstatic.com/generate_204,interval = 60,img-url = https://raw.githubusercontent.com/Semporia/Hand-Painted-icon/master/Rounded_Rectangle/Hong_Kong.png

# å°æ¹¾èŠ‚ç‚¹
å°æ¹¾èŠ‚ç‚¹ = url-test,å°æ¹¾,url = http://www.gstatic.com/generate_204,interval = 60,img-url = https://raw.githubusercontent.com/Semporia/Hand-Painted-icon/master/Rounded_Rectangle/Taiwan.png

# æ—¥æœ¬èŠ‚ç‚¹
æ—¥æœ¬èŠ‚ç‚¹ = url-test,æ—¥æœ¬,url = http://www.gstatic.com/generate_204,interval = 60,img-url = https://raw.githubusercontent.com/Semporia/Hand-Painted-icon/master/Rounded_Rectangle/Japan.png

# ç¾å›½èŠ‚ç‚¹
ç¾å›½èŠ‚ç‚¹ = url-test,ç¾å›½,url = http://www.gstatic.com/generate_204,interval = 60,img-url = https://raw.githubusercontent.com/Semporia/Hand-Painted-icon/master/Rounded_Rectangle/United_States.png


FINAL = select,èŠ‚ç‚¹ç­–ç•¥,DIRECT,img-url = https://raw.githubusercontent.com/Orz-3/mini/master/Color/Final.png


[Remote Filter]
é¦™æ¸¯ = NameRegex, FilterKey = "(?i)(æ¸¯|HK|Hong)"
å°æ¹¾ = NameRegex, FilterKey = "(?i)(å°|TW|Tai)"
æ—¥æœ¬ = NameRegex, FilterKey = "(?i)(æ—¥æœ¬|å·æ—¥|ä¸œäº¬|å¤§é˜ª|æ³‰æ—¥|åŸ¼ç‰|æ²ªæ—¥|æ·±æ—¥|JP|Japan)"
ç¾å›½ = NameRegex, FilterKey = "(?i)(ç¾|æ³¢ç‰¹å…°|è¾¾æ‹‰æ–¯|ä¿„å‹’å†ˆ|å‡¤å‡°åŸ|è´¹åˆ©è’™|ç¡…è°·|æ‹‰æ–¯ç»´åŠ æ–¯|æ´›æ‰çŸ¶|åœ£ä½•å¡|åœ£å…‹æ‹‰æ‹‰|è¥¿é›…å›¾|èŠåŠ å“¥|US|United States)"
å›½é™… = NameRegex, FilterKey = "(?=.*)^((?!(æ¸¯|HK|æ—¥|JP|å°|TW|è¶Š|VN|æ–°|SG|ç¾|US|ğŸ‡¨ğŸ‡³|ğŸ‡­ğŸ‡°|ğŸ‡ºğŸ‡¸|ğŸ‡¯ğŸ‡µ|ğŸ‡»ğŸ‡³|ğŸ‡¸ğŸ‡¬)).)*$"
ALL = NameRegex, FilterKey = "(?=.*)^((?!ç½‘æ˜“).)*$"



[Remote Rule]
https://github.com/Softlyx/QuantumultX/blob/main/rule/anti-ip-attribution.list, policy=èŠ‚ç‚¹ç­–ç•¥, tag=å›½å†…éšè—ip, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/QuantumultX/Speedtest/Speedtest.list, policy=SpeedTest, tag=SpeedTest, enabled=true
https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Unbreak.list, policy=å›½å†…æœåŠ¡, tag=è§„åˆ™ä¿®æ­£, enabled=true
https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Guard/Hijacking.list, policy=èŠ‚ç‚¹ç­–ç•¥, tag=è¿è¥åŠ«æŒ, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/QuantumultX/Hijacking/Hijacking.list, policy=å¹¿å‘Šæ‹¦æˆª, tag=ååŠ«æŒ, enabled=true
https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Guard/Privacy.list, policy=å¹¿å‘Šæ‹¦æˆª, tag=éšç§ä¿æŠ¤, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/QuantumultX/GoogleVoice/GoogleVoice.list, policy=Google Voice, tag=Google Voice, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/QuantumultX/Telegram/Telegram.list, policy=å›½é™…ç¤¾äº¤, tag=Telegram, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/QuantumultX/Twitter/Twitter.list, policy=å›½é™…ç¤¾äº¤, tag=Twitter, enabled=true
https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/StreamingMedia/Video/TikTok.list, policy=TikTokæ¢åŒº, tag=æµ·å¤–æŠ–éŸ³TikTok, enabled=true
https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/StreamingMedia/Streaming.list, policy=å›½å¤–åª’ä½“, tag=å›½é™…åª’ä½“, enabled=true
https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/StreamingMedia/Region/HK.list, policy=é¦™æ¸¯èŠ‚ç‚¹, tag=æµåª’ä½“HK, enabled=true
https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/StreamingMedia/Region/TW.list, policy=å°æ¹¾èŠ‚ç‚¹, tag=æµåª’ä½“TW, enabled=true
https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/StreamingMedia/Region/JP.list, policy=æ—¥æœ¬èŠ‚ç‚¹, tag=æµåª’ä½“JP, enabled=true
https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/StreamingMedia/Region/US.list, policy=ç¾å›½èŠ‚ç‚¹, tag=æµåª’ä½“US, enabled=true
https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Global.list, policy=å…¨çƒåŠ é€Ÿ, tag=å…¨çƒåŠ é€Ÿ, enabled=true
https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Extra/Apple/Apple.list, policy=AppleæœåŠ¡, tag=AppleæœåŠ¡, enabled=true
https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Extra/Apple/AppStore.list, policy=AppleæœåŠ¡, tag=AppStore, enabled=true
https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/Extra/Apple/AppStoreConnect.list, policy=AppleæœåŠ¡, tag=AppStoreConnect, enabled=true
https://raw.githubusercontent.com/DivineEngine/Profiles/master/Quantumult/Filter/StreamingMedia/StreamingCN.list, policy=å›½å†…æœåŠ¡, tag=å›½å†…è§†é¢‘, enabled=true
https://raw.githubusercontent.com/DivineEngine/Profiles/master/Surge/Ruleset/China.list, policy=å›½å†…æœåŠ¡, tag=å›½å†…ç½‘ç«™, enabled=true
https://raw.githubusercontent.com/17mon/china_ip_list/master/china_ip_list.txt, policy=å›½å†…æœåŠ¡, tag=ChinaIPv4, enabled=true
https://gaoyifan.github.io/china-operator-ip/chinanet6.txt, policy=å›½å†…æœåŠ¡, tag=ChinaIPv6, enabled=true


[Rule]
GEOIP,CN,å›½å†…æœåŠ¡
FINAL,FINAL

[URL Rewrite]
enable = false
# äº¬ä¸œæ¯”ä»·Fix
^https?:\/\/api\.m\.jd.com\/client\.action\?functionId=start url reject-200

[Remote Rewrite]

[Script]
enable = false

[Remote Script]
https://raw.githubusercontent.com/Tartarus2014/Loon-Script/master/Fake_Vip.conf, tag=Fake-VIP, enabled=true
https://raw.githubusercontent.com/Tartarus2014/Loon-Script/master/Cookie.conf, tag=Cookie.è·å–å®Œä¸€å®šè¦å…³é—­, enabled=false
https://raw.githubusercontent.com/Tartarus2014/Loon-Script/master/Task.conf, tag=Task, enabled=false
https://raw.githubusercontent.com/Tartarus2014/Loon-Script/master/Script.conf, tag=Script, enabled=false
https://raw.githubusercontent.com/Tartarus2014/Loon-Script/master/JD.conf, tag=JD, enabled=false

[Plugin]
https://raw.githubusercontent.com/chengkongyiban/Loon/main/Loon-Gallery/Rewrite_to_Loon.plugin, tag=QXè½¬LOON, enabled=true
https://raw.githubusercontent.com/Tartarus2014/Loon-Script/master/Plugin/MediaCheck.plugin, tag=Node Detection Tool, enabled=true
https://raw.githubusercontent.com/Tartarus2014/Loon-Script/master/Plugin/Unlock/TikTokJP.plugin, proxy=æ—¥æœ¬èŠ‚ç‚¹, tag=Tiktok, enabled=false
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rewrite/Loon/Advertising/Advertising.plugin, tag=Advertising, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rewrite/Loon/Redirect/Redirect.plugin, tag=General, enabled=true
https://raw.githubusercontent.com/Tartarus2014/Loon-Script/master/Plugin/TF-Download.plugin, tag=TF-Download, enabled=true
https://raw.githubusercontent.com/chavyleung/scripts/master/box/rewrite/boxjs.rewrite.loon.plugin, enabled=true
https://raw.githubusercontent.com/Peng-YM/Sub-Store/master/config/Loon.plugin, tag=è®¢é˜…è§£æå™¨, enabled=true

[MITM]
enable = false
skip-server-cert-verify = true
